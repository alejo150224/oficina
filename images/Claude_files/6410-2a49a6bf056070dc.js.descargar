"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6410],{96410:function(e,t,n){n.d(t,{F:function(){return W},I:function(){return I}});var r=n(58936),u=n(27573),s=n(31257),i=n(11492),a=n(39850),l=n(16096),o=n(51722),c=n(96111),d=n(98426),h=n(92472),m=n(55210),f=n(24566),x=n(24412),p=n(55231),g=n(54206),v=n(95863),j=n(41070),b=n(66365),y=n(44115),_=n(99733),w=n.n(_),C=n(77997),P=n(54603),N=n(7653),S=n(80248),z=n(23904),U=n(57780),E=n(60163),T=n(88521),A=()=>{let{mode:e,setMode:t}=(0,z.useTheme)();return(0,u.jsxs)(b.Tr,{children:[(0,u.jsxs)(d.WR,{className:"text-sm",children:["Appearance ",(0,u.jsx)(f.T,{size:16})]}),(0,u.jsx)(b.Uv,{children:(0,u.jsxs)(d.A2,{sideOffset:4,children:[(0,u.jsxs)(d.hP,{onSelect:()=>t("auto"),children:[(0,u.jsxs)("div",{className:"flex gap-2 items-center pr-4 text-sm",children:[(0,u.jsx)(U.u,{size:16})," System"]}),"auto"===e?(0,u.jsx)(g.J,{size:16}):(0,u.jsx)("div",{className:"w-4 h-4"})]}),(0,u.jsxs)(d.hP,{onSelect:()=>t("light"),children:[(0,u.jsxs)("div",{className:"flex gap-2 items-center text-sm",children:[(0,u.jsx)(E.k,{size:16})," Light"]}),"light"===e?(0,u.jsx)(g.J,{size:16}):(0,u.jsx)("div",{className:"w-4 h-4"})]}),(0,u.jsxs)(d.hP,{onSelect:()=>t("dark"),children:[(0,u.jsxs)("div",{className:"flex gap-2 items-center text-sm",children:[(0,u.jsx)(T.J,{size:16})," Dark"]}),"dark"===e?(0,u.jsx)(g.J,{size:16}):(0,u.jsx)("div",{className:"w-4 h-4"})]})]})})]})},k=n(94354);function O(){let e=(0,r._)(["\n  w-full\n  text-left\n  text-sm\n  disabled:pointer-events-none\n  disabled:shadow-none\n  disabled:drop-shadow-none"]);return O=function(){return e},e}let M=e=>{let{data:t}=(0,k.QR)(),[n,r]=(0,N.useState)([]),[u,s]=(0,N.useState)(null),[i,a]=(0,N.useState)([]),{data:l,error:o}=(0,k.hA)(null!=u?u:"");return(0,N.useEffect)(()=>{if(!t)return;if(l&&l.uuid===u)n.some(e=>e.uuid===l.uuid)||r(e=>[...e,l]);else{if(!o)return;a(e=>[...e,u])}let c=t.find(e=>!n.some(t=>t.uuid===e.uuid)&&!i.includes(e.uuid));c?s(c.uuid):e(n)},[l,o,i,u,n,t,e]),{totalConversations:null==t?void 0:t.length,numExported:n.length,numFailed:i.length,startExporting:()=>{t&&t.length&&s(t[0].uuid)}}},Q=(0,N.forwardRef)((e,t)=>{let[n,r]=(0,N.useState)(!1),[s,i]=(0,N.useState)(null),{totalConversations:a,numExported:l,numFailed:o,startExporting:c}=M(e=>{r(!1),i(JSON.stringify(e,null,2))});return n?(0,u.jsxs)(D,{ref:t,disabled:!0,...e,children:["Exporting: ",l," / ",a,o>0&&" (".concat(o," failed)")]}):s?(0,u.jsx)(D,{ref:t,...e,onClick:()=>{let e=new Blob([s],{type:"application/json"}),t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download="conversations.json",n.click()},children:"Download Conversations"}):(0,u.jsx)(D,{ref:t,...e,onClick:()=>{r(!0),c()},children:"Export all conversations"})});Q.displayName="ExportConversationsWidget";let D=h.Z.button(O());function Z(){let e=(0,r._)(["fixed top-2.5 right-3.5 z-10 flex flex-row items-center gap-2"]);return Z=function(){return e},e}function B(){let e=(0,r._)(["\n  border\n  border-accent-pro-200\n  bg-accent-pro-900\n  rounded-lg\n  mt-1\n  mb-2\n  mx-2\n  py-2\n  px-3\n"]);return B=function(){return e},e}function I(e){let{className:t,showClaudiaVersion:n}=e,{account:r}=(0,l.useCurrentAccount)(),{openConsentBanner:s}=(0,a.useConsent)(),h=null==r?void 0:r.memberships.map(e=>e.organization),p=null==h?void 0:h.some(e=>e.capabilities.includes("api")),g=(0,i.useConfiguration)(),{value:v}=(0,S.useGate)("conversation_export"),j=(0,l.useHasRaven)(),y=n?(0,u.jsxs)(c.Z,{variant:"unstyled",size:"unset",className:"border-0.5 border-border-300 hover:border-border-200 !px-2.5 !py-2 -mx-0.5 rounded-lg !text-left relative group overflow-hidden","data-testid":"user-menu-button",children:[(0,u.jsx)("div",{className:"bg-gradient-to-b from-bg-500/0 to-bg-500/40 absolute inset-0 opacity-70 group-hover:opacity-100 transition-opacity"}),(0,u.jsxs)("div",{className:"flex gap-1.5 items-center w-full relative z-[5]",children:[(0,u.jsx)(o.Z,{account:r,size:"sm"}),(0,u.jsx)("div",{className:"text-sm flex-1 min-w-0 truncate",children:null==r?void 0:r.email_address}),(0,u.jsx)(m.p,{size:12})]})]}):(0,u.jsx)(c.Z,{type:"button",variant:"unstyled",size:"icon_lg",option:"rounded",className:t,"data-testid":"user-menu-button",children:(0,u.jsx)(o.Z,{account:r,size:"lg"})});return(0,u.jsxs)(d.Lt,{align:"end",unstyledTrigger:!0,trigger:y,className:"max-w-xs",children:[(0,u.jsx)(R,{}),(0,u.jsxs)(b.Tr,{children:[(0,u.jsxs)(d.WR,{className:"text-sm",children:["Learn more ",(0,u.jsx)(f.T,{size:16})]}),(0,u.jsx)(b.Uv,{children:(0,u.jsxs)(d.A2,{sideOffset:4,children:[(0,u.jsx)(J,{name:"About Anthropic",path:"/"}),(0,u.jsx)(d.u2,{}),!j&&(0,u.jsx)(J,{name:"Consumer Terms",path:"/legal/consumer-terms"}),(0,u.jsx)(J,{name:"Acceptable Use Policy",path:"/legal/aup"}),(0,u.jsx)(J,{name:"Privacy Policy",path:"/legal/privacy"}),(0,u.jsx)(d.hP,{asChild:!0,children:(0,u.jsx)("button",{className:"w-full text-left text-sm",onClick:s,children:"Your Privacy Choices"})})]})})]}),p&&(0,u.jsx)(u.Fragment,{children:(0,u.jsx)(d.hP,{asChild:!0,children:(0,u.jsxs)(C.default,{href:g.consoleAbsoluteUrl,target:"_blank",className:"text-sm",children:["API Console ",(0,u.jsx)(x.O,{})]})})}),(0,u.jsx)(d.hP,{asChild:!0,children:(0,u.jsxs)(C.default,{href:"https://support.anthropic.com/",target:"_blank",className:"text-sm",children:["Help & Support ",(0,u.jsx)(x.O,{})]})}),(0,u.jsx)(d.u2,{}),v&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(d.hP,{asChild:!0,children:(0,u.jsx)(Q,{})}),(0,u.jsx)(d.u2,{})]}),(0,u.jsx)(d.hP,{asChild:!0,children:(0,u.jsx)(C.default,{href:"/logout",className:"text-sm",children:"Log out"})})]})}let R=()=>{let{account:e}=(0,l.useCurrentAccount)(),t=(0,N.useMemo)(()=>{var t;return null!==(t=null==e?void 0:e.memberships.map(e=>e.organization))&&void 0!==t?t:[]},[e]),n=(0,N.useMemo)(()=>w()(t.filter(e=>e.capabilities.includes("chat")),e=>!e.capabilities.includes("raven"),"name"),[t]),r=n.some(e=>e.capabilities.includes("raven"));return(0,u.jsx)(u.Fragment,{children:e&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{className:"flex justify-between px-2 pb-2 pt-1",children:(0,u.jsx)("span",{className:"text-text-500 text-sm overflow-ellipsis overflow-hidden",children:null==e?void 0:e.email_address})}),n.map(e=>(0,u.jsx)(F,{org:e,hasTeam:r},e.uuid)),(0,u.jsx)(q,{orgs:n}),(0,u.jsx)(d.u2,{}),(0,u.jsx)(d.hP,{asChild:!0,"data-testid":"user-menu-settings",children:(0,u.jsx)(C.default,{href:"/settings/profile",className:"text-sm",children:"Settings"})}),(0,u.jsx)(A,{}),(0,u.jsx)(d.u2,{})]})})},F=e=>{let{org:t,hasTeam:n}=e,{switchAndRefresh:r}=(0,s.z6)(),{activeOrganization:i}=(0,l.useCurrentAccount)(),a=(0,P.usePathname)(),o=t.capabilities.includes("raven")?"Team":t.capabilities.includes("claude_pro")?"Pro":"Free",c=t.uuid===(null==i?void 0:i.uuid),h="Team"===o?t.name:"Personal",m=(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("div",{className:"flex items-center gap-2",children:[(0,u.jsx)(L,{org:t}),(0,u.jsxs)("div",{className:"flex flex-col",children:[(0,u.jsx)("span",{className:"text-text-100 text-sm",children:h}),(0,u.jsxs)("div",{className:"text-xs",children:[(0,u.jsxs)("span",{className:"text-text-300",children:[o," plan"]}),"Free"===o&&c&&n&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(p.o,{size:12,className:"inline"}),(0,u.jsx)(C.default,{href:"/upgrade",className:"text-accent-pro-100 hover transition-all font-medium",children:"Upgrade"})]})]})]})]}),t.uuid===(null==i?void 0:i.uuid)&&(0,u.jsx)(g.J,{weight:"bold",className:"h-4 w-4 text-accent-main-100"})]});return c?(0,u.jsx)(d.AZ,{children:m}):(0,u.jsx)(d.hP,{onSelect:()=>{a.startsWith("/chat/")?r(t.uuid,"/chats"):r(t.uuid)},children:m})},L=e=>{let{org:t}=e,n=t.capabilities.includes("raven")||t.capabilities.includes("claude_pro")?"bg-accent-pro-100":"bg-text-400",r=t.capabilities.includes("raven")?(0,u.jsx)(v.$,{size:16}):(0,u.jsx)(j.n,{size:16});return(0,u.jsx)("div",{className:(0,y.Z)(n,"flex items-center justify-center text-oncolor-100 rounded-full h-7 w-7"),children:r})},J=e=>{let{name:t,path:n}=e,{websiteBaseUrl:r}=(0,i.useConfiguration)();return(0,u.jsx)(d.hP,{asChild:!0,children:(0,u.jsxs)(C.default,{href:"".concat(r).concat(n),target:"_blank",className:"text-sm",children:[t,(0,u.jsx)(x.O,{})]})})},W=h.Z.div(Z()),q=e=>{let{orgs:t}=e,n=(0,s.zW)(),r=(0,N.useMemo)(()=>t.some(e=>e.capabilities.includes("claude_pro")),[t]);if(t.some(e=>e.capabilities.includes("raven"))||r&&n)return null;let i="Get more from Claude with Pro or Team plans.",a="Upgrade Plan ";return r&&(i="Claude's better with your teammates.",a="Add Team Plan"),(0,u.jsxs)(K,{children:[(0,u.jsx)("p",{className:"text-text-300 text-sm",children:i}),(0,u.jsx)(C.default,{href:"/upgrade",className:"text-sm font-medium text-accent-pro-000",children:a})]})},K=h.Z.div(B())},94354:function(e,t,n){n.d(t,{$H:function(){return y},$Y:function(){return _},Ke:function(){return N},PD:function(){return C},QR:function(){return j},Rq:function(){return v},V_:function(){return P},W:function(){return z},_C:function(){return b},gK:function(){return A},hA:function(){return g},j1:function(){return w},j7:function(){return E},lg:function(){return T},o:function(){return p},zU:function(){return U}});var r=n(83041),u=n(16096),s=n(35146),i=n(36665),a=n(28505),l=n(84983),o=n(74822),c=n(99733),d=n.n(c),h=n(54603),m=n(7653),f=n(80248),x=n(50504);let p=(e,t)=>{let{activeOrganization:n}=(0,u.useCurrentAccount)(),i=null==n?void 0:n.uuid;return(0,r.WE)("/api/organizations/".concat(i,"/chat_conversations/").concat(e,"/chat_messages/").concat(t,"/debug"),{queryKey:[s.Ep,{orgUUID:i},{conversationUuid:e},{messageUuid:t}],enabled:!!t})},g=function(e){let{suppressError:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{activeOrganization:n}=(0,u.useCurrentAccount)(),i=null==n?void 0:n.uuid;return(0,r.WE)("/api/organizations/".concat(null!=i?i:"","/chat_conversations/").concat(e),{queryKey:[s.ph,{orgUUID:i},{uuid:e}],staleTime:3e5,enabled:!!i&&!!e,select:e=>({...e,chat_messages:d()(e.chat_messages,"index")}),meta:{noToast:t}})},v=e=>{let t=(0,l.useQueryClient)(),{activeOrganization:n}=(0,u.useCurrentAccount)(),{value:r}=(0,f.useGate)("apps_edit_messages"),a=null==n?void 0:n.uuid,[c,d]=(0,m.useReducer)(e=>e+1,0),h=(0,i.B)([r?s.I8:s.ph,{orgUUID:a},{uuid:e}]),x=(0,m.useMemo)(()=>t.getQueryData(h),[t,h,e,c]);return(0,m.useEffect)(()=>t.getQueryCache().subscribe(e=>{"updated"===e.type&&"success"===e.action.type&&(0,o._x)({queryKey:h},e.query)&&d()}),[t,d,h]),{data:x}},j=()=>{let{activeOrganization:e}=(0,u.useCurrentAccount)(),t=null==e?void 0:e.uuid;return(0,r.WE)("/api/organizations/".concat(null!=t?t:"","/chat_conversations"),{queryKey:[s.tv,{orgUUID:t}],staleTime:3e5,enabled:!!t,select:e=>d()(e,e=>new Date(e.updated_at)).reverse()})},b=function(e){let{suppressError:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{activeOrganization:n}=(0,u.useCurrentAccount)(),i=null==n?void 0:n.uuid,a="/api/organizations/".concat(null!=i?i:"","/chat_conversations/").concat(e,"?tree=True"),l=(0,r.WE)(a,{queryKey:[s.I8,{orgUUID:i},{uuid:e}],staleTime:3e5,enabled:!!i&&!!e,meta:{noToast:t}},x.fX),o=(0,m.useMemo)(()=>l.data?(0,x.kX)(l.data):[],[l.data]);return{...l,currentPath:o}},y=(e,t)=>{let{mutate:n}=_(),r=(0,h.useRouter)(),u=t||(0,a.H)();return(0,m.useCallback)(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{model:void 0,controlsOpen:!1};n({uuid:u,name:"",model:t.model});let s="/chat/".concat(u).concat(t.controlsOpen?"?controls=1":"");r[e](s)},[n,r,e,u])},_=()=>{let{activeOrganization:e}=(0,u.useCurrentAccount)(),t=null==e?void 0:e.uuid,n=(0,l.useQueryClient)(),{value:i}=(0,f.useGate)("apps_edit_messages"),a=[s.tv,{orgUUID:t}],o=e=>[s.ph,{orgUUID:t},{uuid:e}],c=e=>[s.I8,{orgUUID:t},{uuid:e}];return(0,r.uC)("/api/organizations/".concat(null!=t?t:"","/chat_conversations"),"POST",{enabled:!!t,async onMutate(e){let t=o(e.uuid),r={summary:"",created_at:new Date().toISOString(),updated_at:new Date().toISOString(),...e};await Promise.all([n.cancelQueries({queryKey:a}),n.cancelQueries({queryKey:t})]),n.setQueryData(a,e=>e&&[r,...e]),n.setQueryData(t,e=>({...e||{},...r,chat_messages:(null==e?void 0:e.chat_messages)||[]}))},onSuccess:e=>{n.setQueryData(a,t=>{if(!t)return;let n=t.findIndex(t=>t.uuid===e.uuid);if(-1===n)return t;let r=[...t];return r.splice(n,1,e),r}),i?n.setQueryData(c(e.uuid),t=>({...t||{},...e,chat_messages:(null==t?void 0:t.chat_messages)||[],messageByUuid:new Map,parentByChildUuid:new Map,childrenByParentUuid:new Map,selectedChildByUuid:new Map})):n.setQueryData(o(e.uuid),t=>({...t||{},...e,chat_messages:(null==t?void 0:t.chat_messages)||[]}))},onError(e,t){n.setQueryData(a,e=>null==e?void 0:e.filter(e=>e.uuid!==t.uuid)),n.setQueryData(o(t.uuid),void 0)}})},w=()=>{let{activeOrganization:e}=(0,u.useCurrentAccount)(),t=null==e?void 0:e.uuid,{value:n}=(0,f.useGate)("apps_edit_messages"),i=(0,l.useQueryClient)();return(0,r.Ne)(e=>"/api/organizations/".concat(null!=t?t:"","/chat_conversations/").concat(e),"DELETE",(e,t)=>{if(!t)return[];let n=t.findIndex(t=>t.uuid===e);if(!(n>-1))return t;{let e=[...t];return e.splice(n,1),e}},{enabled:!!t,queryKey:[s.tv,{orgUUID:t}],onSuccess:async(e,r)=>{await i.invalidateQueries([n?s.I8:s.ph,{orgUUID:t},{uuid:r}])}})},C=e=>{let{activeOrganization:t}=(0,u.useCurrentAccount)(),n=null==t?void 0:t.uuid;return(0,r.uC)("/api/organizations/".concat(n,"/chat_conversations/").concat(e,"/share"),"POST",{meta:{errorMessage:"There was an error while trying to share the converation. Please try again."}})},P=e=>{let{activeOrganization:t}=(0,u.useCurrentAccount)(),n=null==t?void 0:t.uuid;return(0,r.uC)("/api/organizations/".concat(n,"/share/").concat(e),"DELETE",{meta:{errorMessage:"There was an error while trying to delete the converation. Please try again."}})},N=(e,t)=>{var n;let{activeOrganization:i}=(0,u.useCurrentAccount)(),a=null==i?void 0:i.uuid,{value:o}=(0,f.useGate)("apps_edit_messages"),c=(0,l.useQueryClient)(),d=[o?s.I8:s.ph,{orgUUID:a},{uuid:e}];return(0,r.uC)("/api/organizations/".concat(null!=a?a:"","/chat_conversations/").concat(e,"/chat_messages/").concat(null!==(n=t.uuid)&&void 0!==n?n:"","/chat_feedback"),t.chat_feedback?"PUT":"POST",{enabled:!!a,meta:{errorMessage:"We could not save your feedback. Please try again later."},onSuccess(){c.invalidateQueries(d)}})},S=()=>{let e=(0,l.useQueryClient)(),{activeOrganization:t}=(0,u.useCurrentAccount)(),n=null==t?void 0:t.uuid,{value:r}=(0,f.useGate)("apps_edit_messages");return(0,m.useCallback)((t,u)=>{t&&(e.setQueryData([r?s.I8:s.ph,{orgUUID:n},{uuid:t}],e=>e&&{...e,...u}),e.setQueryData([s.tv,{orgUUID:n}],e=>null==e?void 0:e.map(e=>e.uuid!==t?e:{...e,...u})))},[n,e,r])},z=e=>{let t=(0,l.useQueryClient)(),{activeOrganization:n}=(0,u.useCurrentAccount)(),i=null==n?void 0:n.uuid,{value:a}=(0,f.useGate)("apps_edit_messages"),o=S();return(0,r.uC)("/api/organizations/".concat(i,"/chat_conversations/").concat(e),"PUT",{onMutate:n=>{var r;let{name:u}=n,l=t.getQueryData([a?s.I8:s.ph,{orgUUID:i},{uuid:e}]);return o(e,{name:u}),{oldTitle:null!==(r=null==l?void 0:l.name)&&void 0!==r?r:""}},onError(t,n,r){r&&o(e,{name:r.oldTitle})}})},U=e=>{let t=(0,l.useQueryClient)(),{activeOrganization:n}=(0,u.useCurrentAccount)(),i=null==n?void 0:n.uuid,{value:a}=(0,f.useGate)("apps_edit_messages"),o=S();return(0,r.uC)("/api/organizations/".concat(i,"/chat_conversations/").concat(e),"PUT",{onMutate:n=>{let{model:r}=n,u=t.getQueryData([a?s.I8:s.ph,{orgUUID:i},{uuid:e}]);return o(e,{model:r}),{oldModel:null==u?void 0:u.model}},onError(t,n,r){r&&o(e,{model:r.oldModel})}})},E=e=>{let t=S(),{activeOrganization:n}=(0,u.useCurrentAccount)();return(0,r.uC)("/api/organizations/".concat(null==n?void 0:n.uuid,"/chat_conversations/").concat(e,"/title"),"POST",{onSuccess(n){let{title:r}=n;t(e,{name:null!=r?r:""})},meta:{noToast:!0}})};function T(e){return e.text+e.attachments.map(e=>e.extracted_content).join(" ")}let A=e=>{let{activeOrganization:t}=(0,u.useCurrentAccount)(),n=null==t?void 0:t.uuid;return(0,r.uC)("/api/organizations/".concat(n,"/chat_conversations/").concat(e,"/stop_response"),"POST")}},50504:function(e,t,n){n.d(t,{FC:function(){return i},HX:function(){return m},QC:function(){return l},fX:function(){return h},kX:function(){return x},mj:function(){return p},vv:function(){return f},wZ:function(){return a}});var r=n(43316),u=n(88253),s=n.n(u);let i="new-assistant-message-uuid",a="new-human-message-uuid",l="root";function o(e,t){let n=e.get(t);if(void 0===n){let e=Error("Key not found: ".concat(t));throw(0,r.Tb)(e),e}return n}let c=(e,t)=>{let n=null!=t?t:e.current_leaf_message_uuid;if(!n)return e;for(;n!==l;){var r;let t=o(e.parentByChildUuid,n),u=null===(r=o(e.childrenByParentUuid,t))||void 0===r?void 0:r.indexOf(n);e.selectedChildByUuid.set(t,u),n=t}return{...e,current_leaf_message_uuid:t}},d=e=>{var t,n,r;let u=new Map,s=new Map,i=new Map,a=new Map,o=new Map;if(0===e.chat_messages.length)return{messageByUuid:s,parentByChildUuid:i,childrenByParentUuid:a,selectedChildByUuid:o};for(let t of e.chat_messages)u.set(t.index,t),s.set(t.uuid,t);for(let t of e.chat_messages){let e=t.parent_message_uuid;if(!e){let r=t.index-1;for(;!e&&r>=0;)e=null===(n=u.get(r))||void 0===n?void 0:n.uuid,r--}e=null!=e?e:l,i.set(t.uuid,e),a.set(e,(null!==(r=a.get(e))&&void 0!==r?r:[]).concat(t.uuid)),o.set(e,0)}if(!(null===(t=a.get(l))||void 0===t?void 0:t[0]))throw Error("No root message found");return{messageByUuid:s,parentByChildUuid:i,childrenByParentUuid:a,selectedChildByUuid:o}},h=e=>{let t={...e,...d(e)};return t.current_leaf_message_uuid||c(t),c(t,e.current_leaf_message_uuid)},m=e=>{let t=Array.from(e.messageByUuid.values()).map(e=>e.index);return 0===t.length?-1:Math.max(...t)},f=(e,t)=>{for(let r of(e.chat_messages=e.chat_messages.concat(t),t)){var n;if(!r.parent_message_uuid)throw Error("Parent UUID required");let t=r.parent_message_uuid;e.messageByUuid.set(r.uuid,r),e.parentByChildUuid.set(r.uuid,t);let u=null!==(n=e.childrenByParentUuid.get(t))&&void 0!==n?n:[];u.push(r.uuid),e.childrenByParentUuid.set(t,u),e.selectedChildByUuid.set(t,u.length-1)}return c(e,t[t.length-1].uuid)},x=(e,t)=>{let n=[],r=null!=t?t:l;for(;e.childrenByParentUuid.has(r);){let t=o(e.childrenByParentUuid,r);if(0===t.length)break;let u=o(e.selectedChildByUuid,r),s=o(e.messageByUuid,t[u]);n.push({...s,parent_message_uuid:r===l?void 0:r,nOptions:t.length,selectedOption:u}),r=s.uuid}return n};function p(e,t,n){var r;let u=o(e.parentByChildUuid,t.uuid),i=o(e.childrenByParentUuid,u),a=s()((null!==(r=t.selectedOption)&&void 0!==r?r:0)+n,0,i.length-1);e.selectedChildByUuid.set(u,a);let l=x(e,u);return c(e,l[l.length-1].uuid)}},26631:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(23203),u=n.n(r),s=n(7653);let i=e=>"LSS-".concat(e);function a(e,t){let[n,r]=(0,s.useState)(()=>{try{let n=window.localStorage.getItem(i(e));return n?JSON.parse(n):t}catch(e){return console.log(e),t}}),a=(0,s.useRef)(u()(n=>{try{if(JSON.stringify(n)===JSON.stringify(t)){window.localStorage.removeItem(i(e));return}window.localStorage.setItem(i(e),JSON.stringify(n))}catch(e){console.log(e)}},250)),l=(0,s.useCallback)(()=>{r(t),setTimeout(()=>{a.current.cancel(),window.localStorage.removeItem(i(e))},0)},[r,t,e]);return(0,s.useEffect)(()=>{a.current(n)},[n]),[n,r,l]}},51722:function(e,t,n){var r=n(27573),u=n(16096),s=n(41070),i=n(44115);t.Z=e=>{var t,n,a;let{name:l,account:o,size:c="md"}=e,d=(null!==(a=null!==(n=null!==(t=null!=l?l:null==o?void 0:o.full_name)&&void 0!==t?t:null==o?void 0:o.display_name)&&void 0!==n?n:null==o?void 0:o.email_address)&&void 0!==a?a:"").split(" ").map(e=>0===e.length?"":e[0]).join("").substring(0,2).toLocaleUpperCase(),h=(0,u.useHasProSubscription)();return(0,r.jsx)("div",{className:(0,i.Z)("font-bold rounded-full flex items-center justify-center shrink-0",{"h-4 w-4 text-[7px]":"xs"===c,"h-7 w-7 text-[12px]":"sm"===c,"h-8 w-8 text-[14px]":"md"===c,"h-10 w-10 text-lg":"lg"===c,"h-16 w-16 text-2xl":"xl"===c,"bg-text-200 text-bg-100":!h,"bg-accent-pro-100 text-oncolor-100":h}),children:d||(0,r.jsx)(s.n,{weight:(0,i.Z)({regular:"xs"===c||"sm"===c,light:"md"===c,thin:"lg"===c||"xl"===c}),size:(0,i.Z)({12:"xs"===c||"sm"===c,20:"md"===c,40:"lg"===c||"xl"===c})})})}},98426:function(e,t,n){n.d(t,{A2:function(){return w},AZ:function(){return y},HF:function(){return j},Lt:function(){return x},WR:function(){return _},hP:function(){return b},pb:function(){return v},u2:function(){return C}});var r=n(58936),u=n(27573),s=n(92472),i=n(66365);function a(){let e=(0,r._)(["\n  z-50\n  bg-bg-300\n  border-0.5\n  border-border-300\n  backdrop-blur-xl\n  rounded-lg\n  min-w-[8rem]\n  w-72\n  overflow-hidden\n  p-1\n  text-text-200\n  shadow-element\n"]);return a=function(){return e},e}function l(){let e=(0,r._)(["\n  rounded\n  py-1\n  px-2\n  max-w-full\n  whitespace-nowrap\n  text-ellipsis\n  overflow-hidden\n  outline-none\n  ring-offset-2\n  ring-offset-bg-300\n  ring-accent-main-100\n  focus-visible:outline-none\n  focus-visible:ring-1\n  focus:backdrop-blur-xl\n  hover:backdrop-blur-xl\n  hover:bg-bg-400/50\n"]);return l=function(){return e},e}function o(){let e=(0,r._)(["text-text-500 pt-1 px-2"]);return o=function(){return e},e}function c(){let e=(0,r._)(["\n  py-1\n  px-2\n  rounded-md\n  cursor-pointer\n  whitespace-nowrap\n  overflow-hidden\n  text-ellipsis\n  grid\n  grid-cols-[minmax(0,_1fr)_auto]\n  gap-2\n  items-center\n  outline-none\n  select-none\n  [&[data-highlighted]]:bg-bg-400\n  [&[data-highlighted]]:text-text-000\n"]);return c=function(){return e},e}function d(){let e=(0,r._)(["\n  py-1\n  px-2\n  rounded-md\n  whitespace-nowrap\n  overflow-hidden\n  text-ellipsis\n  flex\n  justify-between\n  gap-2\n  items-center\n"]);return d=function(){return e},e}function h(){let e=(0,r._)(["\n  py-1\n  px-2\n  rounded\n  cursor-pointer\n  whitespace-nowrap\n  overflow-hidden\n  text-ellipsis\n  grid\n  grid-cols-[minmax(0,_1fr)_auto]\n  gap-2\n  items-center\n  outline-none\n  select-none\n  [&[data-highlighted]]:bg-bg-500\n  [&[data-highlighted]]:text-text-000\n"]);return h=function(){return e},e}function m(){let e=(0,r._)(["\n  z-50\n  bg-bg-300\n  border-0.5\n  border-border-300\n  backdrop-blur-xl\n  rounded-lg\n  min-w-[8rem]\n  overflow-hidden\n  p-1\n  text-text-200\n  shadow-element\n"]);return m=function(){return e},e}function f(){let e=(0,r._)(["\n  h-[0.5px]\n  bg-border-300\n  m-1\n"]);return f=function(){return e},e}function x(e){var t;let{trigger:n,children:r,unstyledTrigger:s=!1,...a}=e;return(0,u.jsx)(u.Fragment,{children:(0,u.jsxs)(i.fC,{children:[s?(0,u.jsx)(i.xz,{asChild:!0,children:n}):(0,u.jsx)(g,{asChild:!0,children:n}),(0,u.jsx)(i.Uv,{children:(0,u.jsx)(p,{sideOffset:null!==(t=a.sideOffset)&&void 0!==t?t:4,...a,children:r})})]})})}n(7653);let p=(0,s.Z)(i.VY)(a()),g=(0,s.Z)(i.xz)(l()),v=i.Qk,j=(0,s.Z)(i.Ju)(o()),b=(0,s.Z)(i.ck)(c()),y=s.Z.div(d()),_=(0,s.Z)(i.fF)(h()),w=(0,s.Z)(i.tu)(m()),C=(0,s.Z)(i.VD)(f())},23904:function(e,t,n){n.r(t),n.d(t,{ThemeProvider:function(){return c},useTheme:function(){return x}});var r=n(27573),u=n(23532),s=n(90974),i=n(26631),a=n(7653);let l="(prefers-color-scheme: dark)",o=(0,a.createContext)(void 0);function c(e){let{pathTheme:t,initialTheme:n,children:s}=e,[c,m]=(0,a.useState)(n),f=(0,u.useCookies)(),[x,p]=(0,i.Z)("userThemeMode","auto");(0,a.useEffect)(()=>{d(t)},[t]),(0,a.useEffect)(()=>d(c),[c]),(0,a.useEffect)(()=>h(x,f),[f,x]);let g=(0,a.useCallback)(()=>h(x,f),[f,x]);return(0,a.useEffect)(()=>{if("auto"!==x)return;let e=window.matchMedia(l);return e.addEventListener("change",g),()=>e.removeEventListener("change",g)},[x,g]),(0,r.jsx)(o.Provider,{value:{theme:c,mode:x,setMode:p,setTheme:m},children:s})}let d=e=>{"undefined"!=typeof document&&(document.documentElement.dataset.theme=e,m())},h=(e,t)=>{if("undefined"==typeof document)return;let n=f(e);t.set(s.c.COLOR_MODE,n),document.documentElement.dataset.mode=n,m()},m=()=>{let[e,t,n]=getComputedStyle(document.documentElement).getPropertyValue("--bg-200").split(" "),r="hsl(".concat(e,",").concat(t,",").concat(n,")"),u=document.querySelector('meta[name="theme-color"]');u||((u=document.createElement("meta")).setAttribute("name","theme-color"),document.head.appendChild(u)),u.setAttribute("content",r)},f=e=>{var t;return"auto"!==e?e:(null===(t=window)||void 0===t?void 0:t.matchMedia(l).matches)?"dark":"light"},x=()=>{let e=(0,a.useContext)(o);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e}},36665:function(e,t,n){n.d(t,{B:function(){return u}});var r=n(7653);function u(e){let t=JSON.stringify(e);return(0,r.useMemo)(()=>e,[t])}},28505:function(e,t,n){n.d(t,{H:function(){return r}});let r=()=>void 0===crypto.randomUUID?"".concat(1e7,"-",1e3,"-",4e3,"-",8e3,"-",1e11).replace(/[018]/g,e=>{let t=parseInt(e);return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)}):crypto.randomUUID()}}]);